(this["webpackJsonpproyecto-pw"]=this["webpackJsonpproyecto-pw"]||[]).push([[0],[,,,,,,,,,function(e,t,r){e.exports={post:"Post_post__1pKnC",img_wrapper:"Post_img_wrapper__237N2",action:"Post_action__3Rwon",first:"Post_first__41T0N",last:"Post_last__3nXkf",filled:"Post_filled__2fjtL"}},,,function(e,t,r){e.exports={post_form:"CreatePost_post_form__1cliD",labels:"CreatePost_labels__3LgBj",button:"CreatePost_button__kZlBV",image_container:"CreatePost_image_container__2DRR1"}},,function(e,t,r){e.exports={post_wrapper:"UserHome_post_wrapper__K7_4O",posts_header:"UserHome_posts_header__1SEJf",buttons:"UserHome_buttons__3EgD9"}},function(e,t,r){e.exports={post_wrapper:"AdminHome_post_wrapper__6OxwS",posts_header:"AdminHome_posts_header__2H_Fw",buttons:"AdminHome_buttons__Ie5M4"}},,function(e,t,r){e.exports={comment:"Comments_comment__3XUDq"}},function(e,t,r){e.exports={form:"Login_form__3OqQG",button:"Login_button__3J-oz"}},function(e,t,r){e.exports={post_wrapper:"Bookmarks_post_wrapper__3WL9q",start:"Bookmarks_start__1MOL5"}},,function(e,t,r){e.exports={empty:"Notification_empty__vk6FK",container:"Notification_container__KtP5Y",move:"Notification_move__2A0xN"}},,function(e,t,r){e.exports={post_wrapper:"GetPost_post_wrapper__3_yZS"}},function(e,t,r){e.exports={comment_bar:"CommentBar_comment_bar__1LVcZ"}},,function(e,t,r){e.exports={main_navbar:"Navbar_main_navbar__2CCZ-"}},,,function(e,t,r){e.exports={footer:"Footer_footer__MLAV3"}},,,,,function(e,t,r){},,,function(e,t,r){"use strict";r.r(t);var n=r(2),a=r.n(n),c=r(20),s=r.n(c),o=r(7),u=(r(34),function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,38)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;r(e),n(e),a(e),c(e),s(e)}))}),i=r(3),p=r.n(i),j=r(4),l=r(5),b="https://posts-pw2021.herokuapp.com/api/v1",f=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n,a,c,s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(b,"/auth/signin"),a={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"username=".concat(t,"&password=").concat(r)},e.next=4,fetch(n,a);case 4:return c=e.sent,e.next=7,c.json();case 7:if(void 0===(s=e.sent).errors&&void 0===s.error){e.next=10;break}throw s.errors[0]||s.error;case 10:return o={token:s.token,role:s.role},e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n){var a,c,s,o,u,i,j;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(b,"/post/owned?limit=").concat(r,"&page=").concat(n),c={method:"GET",headers:{Authorization:"Bearer ".concat(t)}},e.next=4,fetch(a,c);case 4:return s=e.sent,e.next=7,s.json();case 7:if(o=e.sent,u=o.data,i=o.pages,void 0===(j=o.error)){e.next=13;break}throw j;case 13:return e.abrupt("return",{data:u,pages:i});case 14:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),x=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n){var a,c,s,o,u,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(b,"/post/all?limit=").concat(r,"&page=").concat(n),c={method:"GET",headers:{Authorization:"Bearer ".concat(t)}},e.next=4,fetch(a,c);case 4:return s=e.sent,e.next=7,s.json();case 7:return o=e.sent,u=o.data,i=o.pages,e.abrupt("return",{data:u,pages:i});case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n,a,c,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(b,"/post/one/").concat(r),a={method:"GET",headers:{Authorization:"Bearer ".concat(t)}},e.next=4,fetch(n,a);case 4:return c=e.sent,e.next=7,c.json();case 7:if(s=e.sent,!c.ok){e.next=12;break}return e.abrupt("return",s);case 12:throw new Error("Post Not Found");case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),O=function(){return{token:localStorage.getItem("token"),role:localStorage.getItem("role"),username:localStorage.getItem("username")}},m=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n,a,c,s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(b,"/post/like/").concat(r),a={method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}},e.next=4,fetch(n,a);case 4:return c=e.sent,e.next=7,c.json();case 7:if(s=e.sent,o=s.message,!c.ok){e.next=13;break}return e.abrupt("return",{message:o});case 13:throw new Error("Post Not Found");case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(b,"/post/toggle/").concat(r),a={method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}},e.next=4,fetch(n,a);case 4:if(!(c=e.sent).ok){e.next=9;break}return e.abrupt("return",c.json().message);case 9:throw new Error(c.json().error);case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),_=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n){var a,c,s,o,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(b,"/post/comment/").concat(r),c={method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(t)},body:"description=".concat(n)},e.next=4,fetch(a,c);case 4:return s=e.sent,e.next=7,s.json();case 7:if(o=e.sent,u=o.message,!s.ok){e.next=13;break}return e.abrupt("return",u);case 13:throw new Error("Post Not Found.");case 14:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n,a){var c,s,o,u,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="".concat(b,"/post/create"),s={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(t)},body:"title=".concat(r,"&description=").concat(n,"&image=").concat(a)},e.next=4,fetch(c,s);case 4:return o=e.sent,e.next=7,o.json();case 7:if(u=e.sent,i=u.message,!o.ok){e.next=13;break}return e.abrupt("return",i);case 13:throw new Error(o.errors[0]);case 14:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),g=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n,a,c){var s,o,u,i,j,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(b,"/post/update/").concat(c),o={method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(t)},body:"title=".concat(r,"&description=").concat(n,"&image=").concat(a)},e.next=4,fetch(s,o);case 4:if(u=e.sent,i=u.json(),j=i.message,l=i.error,!u.ok){e.next=10;break}return e.abrupt("return",j);case 10:throw new Error(l);case 11:case"end":return e.stop()}}),e)})));return function(t,r,n,a,c){return e.apply(this,arguments)}}(),k=function(){var e=Object(j.a)(p.a.mark((function e(t){var r,n,a,c,s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="".concat(b,"/auth/whoami"),n={method:"GET",headers:{Authorization:"Bearer ".concat(t)}},e.next=5,fetch(r,n);case 5:if(!(a=e.sent).ok){e.next=15;break}return e.next=9,a.json();case 9:return c=e.sent,s=c.username,o=c.role,e.abrupt("return",{username:s,role:o});case 15:throw Error("El token no ha sido verificado.");case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{});case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,3,e.next=4,d(t,3,r);case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r){return e.apply(this,arguments)}}(),C=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,3,e.next=4,x(t,3,r);case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r){return e.apply(this,arguments)}}(),S=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m(t,r);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),N=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h(t,r);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),E=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_(t,r,n);case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n,a){var c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w(t,r,n,a);case 3:return c=e.sent,e.abrupt("return",c);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n,a){return e.apply(this,arguments)}}(),P=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t,r);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),I=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n,a,c){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g(t,r,n,a,c);case 3:return s=e.sent,e.abrupt("return",s);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n,a,c){return e.apply(this,arguments)}}(),T=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="".concat(b,"/post/fav/").concat(r),a={method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}},e.next=5,fetch(n,a);case 5:if(!e.sent.ok){e.next=10;break}return e.abrupt("return",{message:"Favorito actualizado.",error:!1});case 10:throw Error("Error al cambiar favorito");case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{message:e.t0,error:!0});case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,r){return e.apply(this,arguments)}}(),A=function(){var e=Object(j.a)(p.a.mark((function e(t){var r,n,a,c,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="".concat(b,"/post/fav"),n={method:"GET",headers:{Authorization:"Bearer ".concat(t)}},e.next=5,fetch(r,n);case 5:return a=e.sent,e.next=8,a.json();case 8:return c=e.sent,s=c.favorites,e.abrupt("return",s);case 13:return e.prev=13,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),B=r(11),L=r(8),F=r(14),H=r.n(F),D=r(22),G=r(6),U=r(9),R=r.n(U),J=r(21),K=r.n(J),M=r(1),V=function(e){var t=e.message;return t?Object(M.jsx)("div",{className:K.a.container,children:t}):null},Z=function(e){var t,r,a,c=e.data,s=Object(G.g)(),o=O(),u=o.token,i=o.username,b=Object(G.h)(),f=0!==c.likes.filter((function(e){return e.username===i})).length,d=null===(t=c.likes)||void 0===t?void 0:t.length,x=c.comments.length,h=Object(n.useState)(f),m=Object(l.a)(h,2),v=m[0],_=m[1],w=Object(n.useState)((null===s||void 0===s||null===(r=s.state)||void 0===r?void 0:r.favorite)||c.favorite),g=Object(l.a)(w,2),k=g[0],y=g[1],C=Object(n.useState)(""),N=Object(l.a)(C,2),E=N[0],z=N[1],P=f===v?0:v?1:-1,I=v?Object(M.jsx)(L.e,{size:24}):Object(M.jsx)(L.h,{size:24}),A=k?Object(M.jsx)(B.a,{className:R.a.filled,size:24}):Object(M.jsx)(B.b,{size:24}),F=function(){var e=Object(j.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(u,c._id);case 2:_(!v);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(j.a)(p.a.mark((function e(){var t,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(u,c._id);case 2:t=e.sent,r=t.message,t.error?(z(""),z(r)):(y(!k),c.favorite=k);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(M.jsxs)("div",{className:R.a.post,children:[Object(M.jsxs)("h2",{children:[c.title,Object(M.jsxs)("span",{children:[" ",null===(a=c.user)||void 0===a?void 0:a.username," "]})]}),Object(M.jsx)("p",{children:c.description}),void 0!==c.image&&Object(M.jsx)("div",{className:R.a.img_wrapper,children:Object(M.jsx)("img",{src:c.image,alt:"Post"})}),Object(M.jsxs)("div",{className:R.a.action,children:[Object(M.jsxs)("button",{id:R.a.first,onClick:F,children:[I," ",d+P," "]}),Object(M.jsxs)("button",{id:R.a.second,onClick:function(){b("/post/".concat(c._id),{replace:!0,state:{favorite:k}})},children:[Object(M.jsx)(D.a,{size:24})," ",x," "]}),Object(M.jsx)("button",{id:R.a.last,onClick:H,children:A})]}),""!==E&&Object(M.jsx)(V,{message:E})]})},q=function(){var e=Object(G.h)(),t=Object(n.useState)(0),r=Object(l.a)(t,2),a=r[0],c=r[1],s=O(),o=s.username,u=s.token,i=Object(n.useState)(0),b=Object(l.a)(i,2),f=b[0],d=b[1],x=Object(n.useState)([]),h=Object(l.a)(x,2),m=h[0],v=h[1],_=f===a-1,w=0===f;return Object(n.useEffect)((function(){var e=function(){var e=Object(j.a)(p.a.mark((function e(){var t,r,n,a,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(u);case 2:return t=e.sent,e.next=5,C(u,f);case 5:r=e.sent,n=r.data,a=r.pages,s=n.map((function(e){return e.favorite=-1!==t.indexOf(e._id),e})),v(s),c(a);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[u,f]),Object(M.jsxs)("section",{className:H.a.post_wrapper,children:[Object(M.jsxs)("div",{className:H.a.posts_header,children:[Object(M.jsxs)("h1",{children:["Bienvenido ",o]}),Object(M.jsxs)("div",{className:H.a.buttons,children:[!w&&Object(M.jsx)("button",{onClick:function(){return d(f-1)},children:Object(M.jsx)(L.d,{size:24})}),!_&&Object(M.jsx)("button",{onClick:function(){return d(f+1)},children:Object(M.jsx)(L.g,{size:24})}),Object(M.jsx)("button",{onClick:function(){e("/bookmarks",{replace:!0})},children:Object(M.jsx)(B.c,{size:24})})]})]}),m.map((function(e){return Object(M.jsx)(Z,{data:e},e._id)}))]})},X=r(15),Q=r.n(X),W=function(e){var t,r=e.data,a=O().token,c=Object(G.h)(),s=Object(n.useState)(r.active),o=Object(l.a)(s,2),u=o[0],i=o[1],p=u?Object(M.jsx)(L.b,{size:24}):Object(M.jsx)(L.c,{size:24});return Object(M.jsxs)("div",{className:R.a.post,children:[Object(M.jsxs)("h2",{children:[r.title,Object(M.jsxs)("span",{children:[" ",null===(t=r.user)||void 0===t?void 0:t.username," "]})]}),Object(M.jsx)("p",{children:r.description}),void 0!==r.image&&Object(M.jsx)("div",{className:R.a.img_wrapper,children:Object(M.jsx)("img",{src:r.image,alt:"Post "})}),Object(M.jsxs)("div",{className:R.a.action,children:[Object(M.jsxs)("button",{id:R.a.first,onClick:function(){P(a,r._id),i(!u)},children:[p," ",u?"Visible":"Invisible"," "]}),Object(M.jsxs)("button",{id:R.a.last,onClick:function(){c("/edit/".concat(r._id),{state:{title:r.title,description:r.description,image:r.image}})},children:[Object(M.jsx)(L.a,{size:24})," Edit Post "]})]})]})},Y=function(){var e=Object(G.h)(),t=O(),r=t.token,a=t.username,c=Object(n.useState)([]),s=Object(l.a)(c,2),o=s[0],u=s[1],i=Object(n.useState)(0),b=Object(l.a)(i,2),f=b[0],d=b[1],x=Object(n.useState)(0),h=Object(l.a)(x,2),m=h[0],v=h[1],_=m===f-1,w=0===m;return Object(n.useEffect)((function(){var e=function(){var e=Object(j.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(r,m);case 2:t=e.sent,d(t.pages),u(t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[r,m]),Object(M.jsxs)("section",{className:Q.a.post_wrapper,children:[Object(M.jsxs)("div",{className:Q.a.posts_header,children:[Object(M.jsxs)("h1",{children:["Post de ",a," "]}),Object(M.jsxs)("div",{className:Q.a.buttons,children:[!w&&Object(M.jsx)("button",{onClick:function(){return v(m-1)},children:Object(M.jsx)(L.d,{size:32})}),!_&&Object(M.jsx)("button",{onClick:function(){return v(m+1)},children:Object(M.jsx)(L.g,{size:32})}),Object(M.jsx)("button",{onClick:function(){e("/create",{replace:!0})},children:Object(M.jsx)(L.f,{size:32})})]})]}),null===o||void 0===o?void 0:o.map((function(e){return Object(M.jsx)(W,{data:e},e._id)}))]})},$=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(t,r);case 3:return n=e.sent,a=n.token,c=n.role,localStorage.setItem("token",a),localStorage.setItem("username",t),localStorage.setItem("role",c),e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,r){return e.apply(this,arguments)}}(),ee=function(){localStorage.removeItem("role"),localStorage.removeItem("token"),localStorage.removeItem("username")},te=function(){var e=Object(j.a)(p.a.mark((function e(){var t,r,n,a,c,s,o,u,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=O(),r=t.token,n=t.username,a=t.role,e.next=3,k(r);case 3:if(c=e.sent,s=c.username,o=c.role,u=n&&a&&n.includes(s)&&a===o){e.next=10;break}return i={route:"/error",options:{replace:!0,state:{error:"No se pudo verificar la identidad \ud83d\udc80.",logOut:!0}}},e.abrupt("return",{identified:u,navObj:i});case 10:return e.abrupt("return",{identified:u});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(e){var t=e.error,r=Object(G.g)().state;Object(n.useEffect)((function(){setTimeout((function(){window.location.replace("/"),r.logOut&&ee()}),2500)}),[null===r||void 0===r?void 0:r.logOut]);var a=void 0===(null===r||void 0===r?void 0:r.error)?t:r.error;return Object(M.jsx)("h1",{children:a})},ne=r(12),ae=r.n(ne),ce=function(e,t){return e.length>=t},se=function(){var e,t,r,a=Object(G.h)(),c=Object(G.g)().state,s=O().token,o=Object(G.i)().postId,u=Object(n.useState)(!0),i=Object(l.a)(u,2),b=i[0],f=i[1],d=Object(n.useState)(!1),x=Object(l.a)(d,2),h=x[0],m=x[1],v=Object(n.useState)(""),_=Object(l.a)(v,2),w=_[0],g=_[1],k=Object(n.useState)(""),y=Object(l.a)(k,2),C=y[0],S=y[1],N=Object(n.useState)(" "),E=Object(l.a)(N,2),P=E[0],T=E[1],A=Object(n.useState)(""),B=Object(l.a)(A,2),L=B[0],F=B[1],H=(t=8,r=32,(e=w).length>=t&&e.length<=r),D=ce(C,8),U=function(e){return new RegExp(".*.(gif|jpe?g|bmp|png)$").test(e)}(P)&&h,R=function(){var e=Object(j.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),f(!1),H){e.next=7;break}return F("El t\xedtulo debe tener entre 8 y 32 caracteres \ud83d\udcbb."),e.abrupt("return");case 7:if(D){e.next=12;break}return F("La descripci\xf3n debe tener m\xednimo 8 caracteres \ud83d\udcce."),e.abrupt("return");case 12:if(U){e.next=17;break}return F("Debes ingresar la url de una imagen \ud83d\udcf8."),e.abrupt("return");case 17:if(!o){e.next=22;break}return e.next=20,I(s,w,C,P,o);case 20:e.next=24;break;case 22:return e.next=24,z(s,w,C,P);case 24:a("/",{replace:!0});case 25:g(""),S(""),T(""),F(o?"Editado con \xe9xito":"Creado con \xe9xito");case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){if(f(!0),o&&c){var e=c.title,t=c.description,r=c.image;g(e),S(t),T(r)}else o&&!c&&a("/error",{replace:!0,state:{error:"Post no existe."}})}),[o,c,a,b]),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("h1",{children:o?"Editar post ".concat(o):"Crear nuevo post"}),Object(M.jsxs)("form",{className:ae.a.post_form,children:[Object(M.jsxs)("div",{className:ae.a.labels,children:[Object(M.jsxs)("label",{children:["T\xedtulo",Object(M.jsx)("input",{type:"text",onChange:function(e){g(e.target.value)},value:w,name:"titulo"})]}),Object(M.jsxs)("label",{children:["Descripci\xf3n",Object(M.jsx)("input",{type:"text",onChange:function(e){S(e.target.value)},value:C,name:"descripcion"})]}),Object(M.jsxs)("label",{children:["Imagen [URL]",Object(M.jsx)("input",{type:"text",onChange:function(e){T(e.target.value)},value:P,name:"url"})]})]}),Object(M.jsxs)("div",{className:ae.a.image_container,children:[" ",Object(M.jsx)("img",{src:P,alt:"post preview",onError:function(e){e.target.style.display="none",m(!1)},onLoad:function(e){e.target.style.display="inline-block",m(!0)}})," "]}),Object(M.jsx)("input",{type:"submit",value:o?"Editar post":"Crear post",className:ae.a.button,onClick:R})]}),b&&Object(M.jsx)(V,{message:L})]})},oe=r(23),ue=r.n(oe),ie=r(17),pe=r.n(ie),je=function(e){var t=e.data;return Object(M.jsx)("div",{className:pe.a.comment_wrapper,children:t.map((function(e){return Object(M.jsxs)("div",{className:pe.a.comment,children:[Object(M.jsx)("h3",{children:e.user.username}),Object(M.jsx)("p",{children:e.description})]},e._id)}))})},le=r(24),be=r.n(le),fe=r(25),de=function(e){var t=e.id,r=O().token,a=Object(n.useState)(""),c=Object(l.a)(a,2),s=c[0],o=c[1],u=Object(n.useState)(!0),i=Object(l.a)(u,2),b=i[0],f=i[1],d=Object(n.useState)(""),x=Object(l.a)(d,2),h=x[0],m=x[1],v=function(){var e=Object(j.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(!1),!ce(s,8)){e.next=6;break}return e.next=4,E(r,t,s);case 4:e.next=7;break;case 6:m("El mensaje debe tener m\xednimo 8 caracteres. \ud83d\udce8");case 7:o("");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){f(!0)}),[b]),Object(M.jsxs)("div",{className:be.a.comment_bar,children:[Object(M.jsx)("input",{type:"text",value:s,onChange:function(e){o(e.target.value)}}),Object(M.jsx)("button",{onClick:v,children:Object(M.jsx)(fe.a,{size:24})}),b&&Object(M.jsx)(V,{message:h})]})},xe=function(e){return e&&0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype},he=function(){var e=Object(G.h)(),t=Object(G.i)().postId,r=O().token,a=Object(n.useState)({}),c=Object(l.a)(a,2),s=c[0],o=c[1];return Object(n.useEffect)((function(){var n=function(){var n=Object(j.a)(p.a.mark((function n(){var a;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,N(r,t);case 2:a=n.sent,xe(a)&&e("/error",{replace:!0,state:{error:"Post no existe."}}),o(a);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}),[e,t,r]),xe(s)?null:Object(M.jsxs)("section",{className:ue.a.post_wrapper,children:[Object(M.jsx)(Z,{data:s}),Object(M.jsx)(je,{data:s.comments}),Object(M.jsx)(de,{id:t})]})},Oe=r(27),me=r(28),ve=r(26),_e=r.n(ve),we=function(){return Object(M.jsx)("nav",{className:_e.a.main_navbar,children:Object(M.jsxs)("ul",{children:[Object(M.jsxs)(o.b,{to:"/",children:[" ",Object(M.jsx)(Oe.a,{size:24})," "]}),Object(M.jsx)(o.b,{to:"/",onClick:ee,children:Object(M.jsx)(me.a,{size:24})})]})})},ge=r(29),ke=r.n(ge),ye=function(){return Object(M.jsxs)("footer",{className:ke.a.footer,children:[Object(M.jsx)("p",{children:"Grupo #47"}),Object(M.jsx)(B.d,{size:32}),Object(M.jsx)("p",{children:"\xa92021"})]})},Ce=function(e){var t=e.children;return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(we,{}),t,Object(M.jsx)(ye,{})]})},Se=function(e){var t=e.role,r=Object(G.g)(),a=Object(G.h)(),c=O().role;return Object(n.useEffect)((function(){var e=function(){var e=Object(j.a)(p.a.mark((function e(){var t,r,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te();case 2:t=e.sent,r=t.identified,n=t.navObj,r||a(n.route,n.options);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()})),c===t?Object(M.jsx)(G.b,{}):void 0===c?Object(M.jsx)(G.a,{to:"/",state:{from:r}}):Object(M.jsx)(G.a,{to:"/error",state:{from:r,error:"Unauthorized page."}})},Ne=r(18),Ee=r.n(Ne),ze=function(){var e=Object(G.h)(),t=Object(n.useState)(""),r=Object(l.a)(t,2),a=r[0],c=r[1],s=Object(n.useState)(""),o=Object(l.a)(s,2),u=o[0],i=o[1],b=Object(n.useState)(""),f=Object(l.a)(b,2),d=f[0],x=f[1],h=Object(n.useState)(!0),m=Object(l.a)(h,2),v=m[0],_=m[1],w=function(e){return function(e){return e&&0!==e.length}(e)},g=function(){var t=Object(j.a)(p.a.mark((function t(r){var n,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),_(!1),!w(a)||!w(u)){t.next=9;break}return t.next=5,$(a,u);case 5:t.sent?(n=O(),"admin"===(c=n.role)?e("/admin",{replace:!0}):"user"===c&&e("/user",{replace:!0})):x("Error en login \ud83d\udd11"),t.next=10;break;case 9:x("No dejes campos vac\xedos \u270d");case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){_(!0)}),[v]),Object(M.jsxs)("form",{onSubmit:g,method:"post",className:Ee.a.form,children:[Object(M.jsxs)("label",{children:["Usuario",Object(M.jsx)("input",{type:"text",onChange:function(e){c(e.target.value)},name:"username",placeholder:"Ingrese username o correo",value:a})]}),Object(M.jsxs)("label",{children:["Contrase\xf1a",Object(M.jsx)("input",{type:"text",onChange:function(e){i(e.target.value)},name:"password",placeholder:"Ingrese contrase\xf1a",value:u})]}),Object(M.jsx)("input",{type:"submit",value:"Ingresar",className:Ee.a.button}),v&&Object(M.jsx)(V,{message:d})]})},Pe=function(){var e=O().role;return"admin"===e?Object(M.jsx)(G.a,{to:"/admin"}):"user"===e?Object(M.jsx)(G.a,{to:"/user"}):Object(M.jsx)(ze,{})},Ie=r(19),Te=r.n(Ie),Ae=function(){var e=O().token,t=Object(n.useState)(void 0),r=Object(l.a)(t,2),a=r[0],c=r[1];return Object(n.useEffect)((function(){var t=function(){var t=Object(j.a)(p.a.mark((function t(){var r,n,a,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A(e);case 2:return r=t.sent,n=[],r.forEach((function(t){n.push(N(e,t))})),t.next=7,Promise.all(n);case 7:return a=t.sent,t.next=10,a.map((function(e){return e.favorite=!0,e}));case 10:s=t.sent,c(s);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e]),void 0===a?Object(M.jsxs)("div",{className:Te.a.start,children:[" ",Object(M.jsx)("p",{children:"Cargando favoritos..."})]}):Object(M.jsx)("div",{className:Te.a.post_wrapper,children:a.map((function(e){return Object(M.jsx)(Z,{data:e},e._id)}))})};var Be=function(){return Object(M.jsxs)(G.e,{children:[Object(M.jsx)(G.c,{path:"/",element:Object(M.jsx)(Pe,{})}),Object(M.jsxs)(G.c,{element:Object(M.jsx)(Se,{role:"admin"}),children:[Object(M.jsx)(G.c,{path:"/create",element:Object(M.jsxs)(Ce,{children:[" ",Object(M.jsx)(se,{})," "]})}),Object(M.jsx)(G.c,{path:"/edit/:postId",element:Object(M.jsxs)(Ce,{children:[" ",Object(M.jsx)(se,{})," "]})}),Object(M.jsx)(G.c,{path:"/admin",element:Object(M.jsxs)(Ce,{children:[" ",Object(M.jsx)(Y,{})," "]})})]}),Object(M.jsxs)(G.c,{element:Object(M.jsx)(Se,{role:"user"}),children:[Object(M.jsx)(G.c,{path:"/user",element:Object(M.jsxs)(Ce,{children:[" ",Object(M.jsx)(q,{})," "]})}),Object(M.jsx)(G.c,{path:"/bookmarks",element:Object(M.jsxs)(Ce,{children:[" ",Object(M.jsx)(Ae,{})," "]})}),Object(M.jsx)(G.c,{path:"/post/:postId",element:Object(M.jsxs)(Ce,{children:[" ",Object(M.jsx)(he,{})," "]})})]}),Object(M.jsx)(G.c,{path:"*",element:Object(M.jsx)(re,{error:"La pagina no existe."})})]})};s.a.render(Object(M.jsx)(a.a.StrictMode,{children:Object(M.jsx)(o.a,{children:Object(M.jsx)(Be,{})})}),document.getElementById("root")),u()}],[[37,1,2]]]);
//# sourceMappingURL=main.cdaf5ad7.chunk.js.map